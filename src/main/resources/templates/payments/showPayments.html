<html layout:decorate="~{layout}" xmlns:th="http://www.thymeleaf.org">
<div layout:fragment="content" class="container my-3">
    <link rel="stylesheet" href="/css/payments/list.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha2/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css" rel="stylesheet">
    <!-- 차트관련 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/js/payments/chart/chart.min.js"></script>
    <link href="/css/payments/bootstrap.min.css" rel="stylesheet">


    <div class="row">
        <!--<div th:replace="~{각페이지에맞는사이드바파일경로::sidebar}"></div>-->
        <div th:replace="~{/test/testSidebar::sidebar}"></div> <!--테스트 사이드바 경로를 넣어놓음-->
        <div style="border: 1px solid black;" class="col-10"> <!--class에서 col-10은 빼면 안됨-->
            //<canvas id="monthlySalesChart" width="400" height="200"></canvas>


            <div class="col-sm-12 col-xl-6">
                <div class="bg-light rounded h-100 p-4">
                    <h6 class="mb-4">Multiple Bar Chart</h6>
                    <canvas id="worldwide-sales"></canvas>
                </div>
            </div>

            <div class="container">
                <h1>매출 보고서</h1>
                <form method="get" action="/payments/showPayments" class="mb-3">
                    <div class="row">
                        <div class="col-md-3"></div> <!-- 왼쪽 여백 -->
                        <div class="col-md-2">
                            <input type="text" id="startDate" name="startDate" class="form-control datepicker" />
                        </div>
                        <div class="col-md-1 mx-auto">
                            <div class="text-center">~</div>
                        </div>
                        <div class="col-md-2">
                            <input type="text" id="endDate" name="endDate" class="form-control datepicker" />
                        </div>
                        <div class="col-md-2">
                            <div class="form-check form-check-inline">
                                <input type="radio" name="view" value="daily" id="daily" class="form-check-input" checked />
                                <label for="daily" class="form-check-label">Daily</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input type="radio" name="view" value="month" id="month" class="form-check-input" />
                                <label for="month" class="form-check-label">Month</label>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <button type="submit" class="btn btn-primary">Show Payments</button>
                        </div>
                    </div>
                </form>

                <table class="table">
                    <thead>
                    <tr>
                        <th>일/월</th>
                        <th>건수</th>
                        <th>매출금액</th>
                    </tr>
                    </thead>
                    <tbody>
                    <!-- 데이터를 동적으로 생성 -->
                    <tr th:each="data : ${paymentsPage.content}" th:unless="${view} != 'month'">
                        <td th:text="${data[0]}"></td>
                        <td th:text="${data[1]}"></td>
                        <td th:text="${data[2]}"></td>
                    </tr>
                    <!-- For the "daily" view -->
                    <tr th:each="data : ${paymentsPage.content}" th:unless="${view} != 'daily'">
                        <td th:text="${data[0]?.paymentDate}"></td>
                        <td th:text="${data[1]}"></td>
                        <td th:text="${data[2]}"></td>
                    </tr>
                    </tbody>
                </table>
            </div>
                <!-- 페이지 네이션 처리 -->
                <div id="pagination">
                    <nav aria-label="Page navigation example">
                        <ul class="pagination justify-content-center">
                            <!-- 이전 페이지 링크 -->
                            <li class="page-item" th:classappend="${paymentsPage.pageable.pageNumber == 0} ? 'disabled'">
                                <a class="page-link" href="#" th:href="@{/payments/showPayments(page=${paymentsPage.pageable.pageNumber - 1}, startDate=${startDate}, endDate=${endDate}, view=${view})}" aria-label="Previous">
                                    <span aria-hidden="true">&laquo;</span>
                                </a>
                            </li>
                            <!-- 페이지 번호 링크 -->
                            <li class="page-item" th:classappend="${i - 1 == paymentsPage.pageable.pageNumber} ? 'disabled'" th:each="i : ${#numbers.sequence(startPage, endPage)}">
                                <a class="page-link" href="#" th:href="@{/payments/showPayments(page=${i - 1}, startDate=${startDate}, endDate=${endDate}, view=${view})}" th:text="${i}"></a>
                            </li>
                            <!-- 다음 페이지 링크 -->
                            <li class="page-item" th:classappend="${paymentsPage.totalPages == paymentsPage.pageable.pageNumber + 1} ? 'disabled'">
                                <a class="page-link" href="#" th:href="@{/payments/showPayments(page=${paymentsPage.pageable.pageNumber + 1}, startDate=${startDate}, endDate=${endDate}, view=${view})}" aria-label="Next">
                                    <span aria-hidden="true">&raquo;</span>
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>
        </div>
    </div>
    <script>
        $(document).ready(function() {
            // Initialize the datepickers
            $('.datepicker').datepicker({
                format: 'yyyy-mm-dd', // Specify the date format
                todayBtn: 'linked',
                clearBtn: true,
                autoclose: true
            });
        });
    </script>
    <script>
        // 월별 매출 데이터 (예시 데이터)
        var monthlyData = {
            labels: ["2023-10", "2023-11", "2023-12", "2024-01"], // 월별 레이블
            datasets: [
                {
                    label: "매출금액",
                    data: [1000, 1500, 1200, 1800], // 월별 매출 데이터
                    backgroundColor: "rgba(75, 192, 192, 0.2)", // 그래프의 배경색
                    borderColor: "rgba(75, 192, 192, 1)", // 그래프의 선 색
                    borderWidth: 1 // 그래프 선의 두께
                }
            ]
        };

        var ctx = document.getElementById("monthlySalesChart").getContext("2d");
        var myChart = new Chart(ctx, {
            type: "bar",
            data: monthlyData,
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    </script>


    <!--     <script>
             // 페이지가 로드될 때 Datepicker 초기화
             document.addEventListener("DOMContentLoaded", function () {
                 // 시작 날짜 선택 위젯
                 const startDateInput = document.getElementById("startDate");
                 const startDatePicker = new Datepicker(startDateInput, {
                     format: 'yyyy-mm-dd',
                     todayBtn: 'linked',
                     clearBtn: true,
                     autoclose: true,
                 });

                 // 종료 날짜 선택 위젯
                 const endDateInput = document.getElementById("endDate");
                 const endDatePicker = new Datepicker(endDateInput, {
                     format: 'yyyy-mm-dd',
                     todayBtn: 'linked',
                     clearBtn: true,
                     autoclose: true,
                 });
             });
         </script>
     <script>
         // 라디오 버튼 변경 시, 월별 또는 일별 데이터 요청
         const monthlyRadio = document.getElementById("monthly");
         const dailyRadio = document.getElementById("daily");

         monthlyRadio.addEventListener("change", () => {
             // 월별 데이터 요청
             // 월별 데이터를 받아서 페이지 갱신 (JavaScript 또는 AJAX 요청으로 구현)
         });

         dailyRadio.addEventListener("change", () => {
             // 일별 데이터 요청
             // 일별 데이터를 받아서 페이지 갱신 (JavaScript 또는 AJAX 요청으로 구현)
         });
     </script>
 -->
</div>
</html>